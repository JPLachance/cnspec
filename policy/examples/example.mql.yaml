owner_mrn: //policy.api.mondoo.app
policies:
  - uid: example1
    name: Example policy
    version: "1.0.0"
    owner_mrn: ""
    is_public: true
    authors:
      - name: Mondoo
        email: hello@mondoo.com
    tags: {'linux', 'ssh', 'sshd', 'openssh'}
    specs:
      - scoring_queries:
          sshd-07:
          sshd-08:
          sshd-09:
          sshd-10:
          sshd-11:
        data_queries:
          sshd-d-1:
          sshd-d-3:
        asset_filter:
          query: platform.family.contains(_ == 'unix')
  - uid: example2
    name: Another policy
    version: "1.0.0"
    specs:
      - policies:
          example1:
        scoring_queries:
          sshd-12:
        asset_filter:
          query: platform.family.contains(_ == 'unix')
queries:
  - uid: sshd-07
    title: Set the port to 22
    query: sshd.config.params["Port"] == 22
    severity: 30
  - uid: sshd-08
    title: Configure the address family
    query: sshd.config.params["AddressFamily"] == /inet|inet6|any/
    severity: 40
  - uid: sshd-09
    title: Do not bind to a open listen address
    query: |
      sshd.config.params["ListenAddress"] != ""
      sshd.config.params["ListenAddress"] != "0.0.0.0"
  - uid: sshd-10
    title: Set the protocol to 2
    query: sshd.config.params["Protocol"] == 2
    severity: 90
  - uid: sshd-11
    title: Enable strict mode
    query: sshd.config.params["StrictModes"] == "yes"
    severity: 70
  - uid: sshd-12
    title: Set logging to auth
    query: sshd.config.params["SyslogFacility"] == "AUTH"
  - uid: sshd-d-1
    title: Gather SSH config params
    query: sshd.config.params
  - uid: sshd-d-3
    title: Gather SSH Config Path
    query: sshd.config.file.path
