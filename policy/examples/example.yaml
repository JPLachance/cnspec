owner_mrn: //policy.api.mondoo.app
policies:
  - uid: example
    name: Example Policy
    version: "1.0.0"
    owner_mrn: ""
    is_public: true
    authors:
      - name: Mondoo
        email: hello@mondoo.com
    tags:
      linux:
      ssh:
      sshd:
      openssh:
    props:
      sshdTestCiphers:
    specs:
      - policies:
        scoring_queries:
          sshd-01:
          sshd-07:
          sshd-10:
          sshd-11:
        data_queries:
          sshd-d-1:
          sshd-d-3:
        asset_filter:
          query: platform.family.contains(_ == 'unix')
queries:
  - uid: sshd-07
    title: Set the port to 22
    query: sshd.config.params["Port"] == 22
  - uid: sshd-08
    title: Configure the address family
    query: sshd.config.params["AddressFamily"] == /inet|inet6|any/
  - uid: sshd-09
    title: Do not bind to a open listen address
    query: |
      sshd.config.params["ListenAddress"] != ""
      sshd.config.params["ListenAddress"] != "0.0.0.0"
  - uid: sshd-10
    title: Set the protocol to 2
    query: sshd.config.params["Protocol"] == 2
  - uid: sshd-11
    title: Enable strict mode
    query: sshd.config.params["StrictModes"] == "yes"
  - uid: sshd-12
    title: Set logging to auth
    query: sshd.config.params["SyslogFacility"] == "AUTH"
  - uid: sshd-d-1
    title: Gather SSH config params
    query: sshd.config.params
  - uid: sshd-d-3
    title: Gather SSH Config Path
    query: sshd.config.file.path
